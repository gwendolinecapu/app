[debug] [2026-01-04T02:14:50.718Z] ----------------------------------------------------------------------
[debug] [2026-01-04T02:14:50.722Z] Command:       /opt/homebrew/Cellar/node/25.2.0/bin/node /Users/leo/plural-connect/node_modules/.bin/firebase deploy --only storage,functions
[debug] [2026-01-04T02:14:50.722Z] CLI Version:   15.1.0
[debug] [2026-01-04T02:14:50.722Z] Platform:      darwin
[debug] [2026-01-04T02:14:50.722Z] Node Version:  v25.2.0
[debug] [2026-01-04T02:14:50.722Z] Time:          Sun Jan 04 2026 03:14:50 GMT+0100 (Central European Standard Time)
[debug] [2026-01-04T02:14:50.723Z] ----------------------------------------------------------------------
[debug] 
[debug] [2026-01-04T02:14:53.084Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2026-01-04T02:14:53.084Z] > authorizing via signed-in user (gamepartagewartail243@gmail.com)
[debug] [2026-01-04T02:14:53.084Z] [iam] checking project app-tdi for permissions ["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]
[debug] [2026-01-04T02:14:53.084Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:14:53.084Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:14:53.085Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/app-tdi:testIamPermissions [none]
[debug] [2026-01-04T02:14:53.085Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/app-tdi:testIamPermissions x-goog-quota-user=projects/app-tdi
[debug] [2026-01-04T02:14:53.085Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/app-tdi:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[debug] [2026-01-04T02:14:53.309Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/app-tdi:testIamPermissions 200
[debug] [2026-01-04T02:14:53.310Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/app-tdi:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[debug] [2026-01-04T02:14:53.310Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:14:53.310Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:14:53.310Z] >>> [apiv2][query] POST https://iam.googleapis.com/v1/projects/app-tdi/serviceAccounts/app-tdi@appspot.gserviceaccount.com:testIamPermissions [none]
[debug] [2026-01-04T02:14:53.310Z] >>> [apiv2][body] POST https://iam.googleapis.com/v1/projects/app-tdi/serviceAccounts/app-tdi@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[debug] [2026-01-04T02:14:53.970Z] <<< [apiv2][status] POST https://iam.googleapis.com/v1/projects/app-tdi/serviceAccounts/app-tdi@appspot.gserviceaccount.com:testIamPermissions 404
[debug] [2026-01-04T02:14:53.970Z] <<< [apiv2][body] POST https://iam.googleapis.com/v1/projects/app-tdi/serviceAccounts/app-tdi@appspot.gserviceaccount.com:testIamPermissions {"error":{"code":404,"message":"Unknown service account","status":"NOT_FOUND"}}
[debug] [2026-01-04T02:14:53.971Z] [functions] service account IAM check errored, deploy may fail: Request to https://iam.googleapis.com/v1/projects/app-tdi/serviceAccounts/app-tdi@appspot.gserviceaccount.com:testIamPermissions had HTTP Error: 404, Unknown service account {"name":"FirebaseError","children":[],"context":{"body":{"error":{"code":404,"message":"Unknown service account","status":"NOT_FOUND"}},"response":{"statusCode":404}},"exit":1,"message":"Request to https://iam.googleapis.com/v1/projects/app-tdi/serviceAccounts/app-tdi@appspot.gserviceaccount.com:testIamPermissions had HTTP Error: 404, Unknown service account","status":404}
[info] 
[info] === Deploying to 'app-tdi'...
[info] 
[info] i  deploying storage, functions 
[info] Running command: npm --prefix "$RESOURCE_DIR" run lint
[info] Running command: npm --prefix "$RESOURCE_DIR" run build
[info] ✔  functions: Finished running predeploy script. 
[info] i  storage: ensuring required API firebasestorage.googleapis.com is enabled... 
[debug] [2026-01-04T02:14:57.836Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:14:57.837Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:14:57.837Z] >>> [apiv2][query] GET https://firebasestorage.googleapis.com/v1alpha/projects/app-tdi/defaultBucket [none]
[debug] [2026-01-04T02:14:58.425Z] <<< [apiv2][status] GET https://firebasestorage.googleapis.com/v1alpha/projects/app-tdi/defaultBucket 200
[debug] [2026-01-04T02:14:58.425Z] <<< [apiv2][body] GET https://firebasestorage.googleapis.com/v1alpha/projects/app-tdi/defaultBucket {"name":"projects/app-tdi/defaultBucket","location":"US-CENTRAL1","bucket":{"name":"projects/app-tdi/buckets/app-tdi.firebasestorage.app"},"storageClass":"REGIONAL"}
[info] i  firebase.storage: checking storage.rules for compilation errors... 
[debug] [2026-01-04T02:14:58.426Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:14:58.426Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:14:58.426Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/app-tdi:test [none]
[debug] [2026-01-04T02:14:58.426Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/app-tdi:test [omitted]
[debug] [2026-01-04T02:14:59.106Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/app-tdi:test 200
[debug] [2026-01-04T02:14:59.106Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/app-tdi:test {}
[info] ✔  firebase.storage: rules file storage.rules compiled successfully 
[debug] [2026-01-04T02:14:59.109Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:14:59.109Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:14:59.109Z] >>> [apiv2][query] GET https://cloudresourcemanager.googleapis.com/v1/projects/app-tdi [none]
[debug] [2026-01-04T02:14:59.748Z] <<< [apiv2][status] GET https://cloudresourcemanager.googleapis.com/v1/projects/app-tdi 200
[debug] [2026-01-04T02:14:59.749Z] <<< [apiv2][body] GET https://cloudresourcemanager.googleapis.com/v1/projects/app-tdi {"projectNumber":"280489246228","projectId":"app-tdi","lifecycleState":"ACTIVE","name":"app-tdi","labels":{"firebase":"enabled","firebase-core":"disabled"},"createTime":"2025-12-28T23:42:34.253168Z"}
[info] i  functions: preparing codebase default for deployment 
[info] i  functions: ensuring required API cloudfunctions.googleapis.com is enabled... 
[info] i  functions: ensuring required API cloudbuild.googleapis.com is enabled... 
[info] i  artifactregistry: ensuring required API artifactregistry.googleapis.com is enabled... 
[debug] [2026-01-04T02:14:59.750Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:14:59.750Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:14:59.750Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/app-tdi/adminSdkConfig [none]
[debug] [2026-01-04T02:15:00.338Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/app-tdi/adminSdkConfig 200
[debug] [2026-01-04T02:15:00.338Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/app-tdi/adminSdkConfig {"projectId":"app-tdi","storageBucket":"app-tdi.firebasestorage.app"}
[debug] [2026-01-04T02:15:00.340Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:00.340Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:00.340Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/app-tdi/configs [none]
[debug] [2026-01-04T02:15:00.588Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/app-tdi/configs 200
[debug] [2026-01-04T02:15:00.589Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/app-tdi/configs {}
[debug] [2026-01-04T02:15:00.591Z] Validating nodejs source
[warn] ⚠  functions: package.json indicates an outdated version of firebase-functions. Please upgrade using npm install --save firebase-functions@latest in your functions directory. 
[warn] ⚠  functions: Please note that there will be breaking changes when you upgrade. 
[debug] [2026-01-04T02:15:01.009Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint",
    "lint:fix": "eslint --fix",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "22"
  },
  "main": "lib/index.js",
  "dependencies": {
    "@google-cloud/vertexai": "^1.0.0",
    "firebase-admin": "^12.0.0",
    "firebase-functions": "^5.0.0",
    "google-auth-library": "^10.5.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2026-01-04T02:15:01.009Z] Building nodejs source
[info] i  functions: Loading and analyzing source code for codebase default to determine what to deploy 
[debug] [2026-01-04T02:15:01.010Z] Could not find functions.yaml. Must use http discovery
[debug] [2026-01-04T02:15:01.017Z] Found firebase-functions binary at '/Users/leo/plural-connect/functions/node_modules/.bin/firebase-functions'
[info] Serving at port 8303

[debug] [2026-01-04T02:15:02.025Z] Got response from /__/functions.yaml {"endpoints":{"performBirthRitual":{"platform":"gcfv1","labels":{},"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"serviceAccountEmail":null,"vpc":null,"callableTrigger":{},"entryPoint":"performBirthRitual"},"generateMagicPost":{"platform":"gcfv1","labels":{},"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"serviceAccountEmail":null,"vpc":null,"callableTrigger":{},"entryPoint":"generateMagicPost"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[info] i  extensions: ensuring required API firebaseextensions.googleapis.com is enabled... 
[debug] [2026-01-04T02:15:06.087Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:06.087Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:06.087Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/app-tdi/services/firebaseextensions.googleapis.com [none]
[debug] [2026-01-04T02:15:06.087Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/app-tdi/services/firebaseextensions.googleapis.com x-goog-quota-user=projects/app-tdi
[debug] [2026-01-04T02:15:06.903Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/app-tdi/services/firebaseextensions.googleapis.com 200
[debug] [2026-01-04T02:15:06.904Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/app-tdi/services/firebaseextensions.googleapis.com [omitted]
[info] ✔  extensions: required API firebaseextensions.googleapis.com is enabled 
[debug] [2026-01-04T02:15:06.913Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2026-01-04T02:15:06.913Z] > authorizing via signed-in user (gamepartagewartail243@gmail.com)
[debug] [2026-01-04T02:15:06.914Z] [iam] checking project app-tdi for permissions ["firebase.projects.get","firebaseextensions.instances.list"]
[debug] [2026-01-04T02:15:06.914Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:06.914Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:06.914Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/app-tdi:testIamPermissions [none]
[debug] [2026-01-04T02:15:06.914Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/app-tdi:testIamPermissions x-goog-quota-user=projects/app-tdi
[debug] [2026-01-04T02:15:06.914Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/app-tdi:testIamPermissions {"permissions":["firebase.projects.get","firebaseextensions.instances.list"]}
[debug] [2026-01-04T02:15:07.523Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/app-tdi:testIamPermissions 200
[debug] [2026-01-04T02:15:07.524Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/app-tdi:testIamPermissions {"permissions":["firebase.projects.get","firebaseextensions.instances.list"]}
[debug] [2026-01-04T02:15:07.525Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:07.525Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:07.525Z] >>> [apiv2][query] GET https://firebaseextensions.googleapis.com/v1beta/projects/app-tdi/instances pageSize=100&pageToken=
[debug] [2026-01-04T02:15:08.292Z] <<< [apiv2][status] GET https://firebaseextensions.googleapis.com/v1beta/projects/app-tdi/instances 200
[debug] [2026-01-04T02:15:08.293Z] <<< [apiv2][body] GET https://firebaseextensions.googleapis.com/v1beta/projects/app-tdi/instances {"instances":[{"name":"projects/app-tdi/instances/firestore-revenuecat-purchases","createTime":"2025-12-30T17:21:15.276371Z","updateTime":"2025-12-30T17:26:03.699847Z","state":"ACTIVE","config":{"name":"projects/app-tdi/instances/firestore-revenuecat-purchases/configurations/82c8e789-d20b-421f-8490-ebaf29830ea3","createTime":"2025-12-30T17:21:15.276371Z","source":{"name":"projects/revenuecat-extensions/sources/f51135a7-2bfe-4d3b-9814-fea305f79838","packageUri":"https://storage.googleapis.com/firebase-extensions-packages-prod/revenuecat-firestore-revenuecat-purchases-0.1.18-9e475416-196b-41bb-adc9-7c3c5ea599af.zip","hash":"617edb9f38162612e87e9bb39750243bedc6febdf946ff3dac916c057af40245","extensionRoot":"/","spec":{"specVersion":"v1beta","name":"firestore-revenuecat-purchases","version":"0.1.18","description":"Facilitates in-app purchases and subscriptions, controls access to premium content, and syncs purchase information to Firestore.","roles":[{"role":"datastore.user","reason":"Allows RevenueCat to store customer and event information in Cloud Firestore."},{"role":"firebaseauth.admin","reason":"Allows RevenueCat to store entitlement information in user custom claims."}],"resources":[{"name":"handler","type":"firebaseextensions.v1beta.function","propertiesYaml":"httpsTrigger: {}\nlocation: ${LOCATION}\nruntime: nodejs20\n","description":"Listens for RevenueCat server webhook requests, and store customer information and events in Cloud Firestore.","deletionPolicy":"DELETE"}],"billingRequired":true,"author":{"authorName":"RevenueCat","url":"https://github.com/RevenueCat/firestore-revenuecat-purchases"},"license":"apache-2.0","sourceUrl":"https://github.com/RevenueCat/firestore-revenuecat-purchases/tree/main","params":[{"param":"LOCATION","label":"Cloud Functions location","type":"SELECT","description":"Where do you want to deploy the functions created for this extension? You usually want a location close to your database. For help selecting a location, refer to the [location selection guide](/docs/functions/locations).","required":true,"options":[{"value":"us-central1","label":"Iowa (us-central1)"},{"value":"us-east1","label":"South Carolina (us-east1)"},{"value":"us-east4","label":"Northern Virginia (us-east4)"},{"value":"us-west2","label":"Los Angeles (us-west2)"},{"value":"us-west3","label":"Salt Lake City (us-west3)"},{"value":"us-west4","label":"Las Vegas (us-west4)"},{"value":"europe-central2","label":"Warsaw (europe-central2)"},{"value":"europe-west1","label":"Belgium (europe-west1)"},{"value":"europe-west2","label":"London (europe-west2)"},{"value":"europe-west3","label":"Frankfurt (europe-west3)"},{"value":"europe-west6","label":"Zurich (europe-west6)"},{"value":"asia-east2","label":"Hong Kong (asia-east2)"},{"value":"asia-northeast1","label":"Tokyo (asia-northeast1)"},{"value":"asia-northeast2","label":"Osaka (asia-northeast2)"},{"value":"asia-northeast3","label":"Seoul (asia-northeast3)"},{"value":"asia-south1","label":"Mumbai (asia-south1)"},{"value":"asia-southeast2","label":"Jakarta (asia-southeast2)"},{"value":"northamerica-northeast1","label":"Montreal (northamerica-northeast1)"},{"value":"southamerica-east1","label":"Sao Paulo (southamerica-east1)"},{"value":"australia-southeast1","label":"Sydney (australia-southeast1)"}],"default":"us-east1","immutable":true},{"param":"REVENUECAT_EVENTS_COLLECTION","label":"RevenueCat Webhook Events Firestore collection","type":"STRING","description":"What is the path to the Cloud Firestore collection where the extension should store RevenueCat events? Leave empty if you do not want the extension to store RevenueCat events.\n(You can later modify this value in Google Firestore > Extensions > Extension Configuration > Reconfigure extension)","validationRegex":"^[^/]+(/[^/]+/[^/]+)*$","validationErrorMessage":"Firestore collection paths must be an odd number of segments separated by slashes, e.g. \"path/to/collection\"."},{"param":"REVENUECAT_CUSTOMERS_COLLECTION","label":"Location of the customers collection","type":"STRING","description":"What is the path to the Cloud Firestore collection where the extension should store RevenueCat customer details? This can be the location of an existing user collection, the extension will not overwrite your existing data but rather merge the RevenueCat data into your existing firestore documents. Leave empty if you do not want the extension to store RevenueCat customer details.\nIt supports placeholders for app_user_id, for example: users/{app_user_id}/purchaser-info Will save the purchaser-info on a document named also \"{app_user_id}\" under the subcollection \"purchaser-info\"\n(You can later modify this value in Google Firestore > Extensions > Extension Configuration > Reconfigure extension)","validationRegex":"^[^/]+(/[^/]+/[^/]+)*$","validationErrorMessage":"Firestore collection paths must be an odd number of segments separated by slashes, e.g. \"path/to/collection\"."},{"param":"SET_CUSTOM_CLAIMS","label":"Should custom claims be set in Firebase Auth with the user's active entitlements?","type":"SELECT","description":"Do you want to automatically update your Firebase Authentication User's custom claims with their current entitlements? (More information: https://firebase.google.com/docs/auth/admin/custom-claims)\nIf set to \"ENABLED\", the extension will consider the app_user_id of the user to match the user's Firebase Authentication UID and set a \"Custom Claim\" with their current active entitlements.","required":true,"options":[{"value":"ENABLED","label":"ENABLED"},{"value":"DISABLED","label":"DISABLED"}],"default":"DISABLED"},{"param":"REVENUECAT_SHARED_SECRET","label":"RevenueCat Firebase Integration Shared Secret","type":"SECRET","description":"What is the webhook shared secret for the Firebase integration of your RevenueCat project? You will find this in the RevenueCat dashboard under Projects > [your project] > Integrations > Firebase","required":true,"example":"my_shared_secret","validationRegex":"^.+$"}],"preinstallContent":"RevenueCat’s app monetization platform empowers developers to confidently deploy in-app purchases and subscriptions, centralize data, and grow revenue. RevenueCat builds and adapts to the ever-changing needs of in-app purchase infrastructure, freeing app businesses to invest their time and resources in growing their product.\n\nInstall this extension to use Firebase services as your RevenueCat backend for in-app purchases on Apple App Store, Google Play Store, and Amazon Appstore.\n\nThe extension makes in-app purchases and subscriptions, controls access to premium content, and syncs customer purchase information to Firestore using [RevenueCat](https://www.revenuecat.com/).\n\nThis extension can:\n\n- Store purchase lifecycle events (e.g., trial starts, purchases, subscription renewals, billing issues) in Firestore and react to them.\n- Store and update information about customers and their purchases in Firestore.\n- Update information about customers' entitlements as Firebase Authentication [Custom Claims](https://firebase.google.com/docs/auth/admin/custom-claims).\n\nRevenueCat supports both native iOS and Android apps as well as hybrid cross-platform apps in [React Native](https://docs.revenuecat.com/docs/reactnative), [Flutter](https://docs.revenuecat.com/docs/flutter), [Unity](https://docs.revenuecat.com/docs/unity), [Cordova](https://docs.revenuecat.com/docs/cordova), and [Ionic](https://docs.revenuecat.com/docs/ionic).\n\nYou need to [create a RevenueCat account](https://app.revenuecat.com/signup) or already have one set up to use this extension.\n\n#### Events\n\nThis extension emits events, which allows you to listen to and run custom logic at different trigger points during the functioning of the extension. For example you can listen to events when a new subscription has been purchased via the `initial_purchase` event, or whenever a subscription or non-renewing purchase has been cancelled through the `cancellation` event.\n\n#### Additional setup\n\n##### Firebase\n\nBefore installing this extension, set up the following Firebase services in your Firebase project:\n\n- [Cloud Firestore](https://firebase.google.com/docs/firestore) to store In-App Purchases & Subscriptions details.\n  - Follow the steps in the [documentation](https://firebase.google.com/docs/firestore/quickstart#create) to create a Cloud Firestore database.\n- (optional) [Firebase Authentication](https://firebase.google.com/docs/auth) to enable different sign-up options for your users to enable Custom Claims management.\n  - Enable the sign-in methods in the [Firebase console](https://console.firebase.google.com/project/_/authentication/providers) that you want to offer your users.\n\n##### RevenueCat\n\n- Create a [RevenueCat Project](https://docs.revenuecat.com/docs/projects) if you haven't already.\n- [Set up a Firebase integration](https://docs.revenuecat.com/docs/firebase-integration) in [RevenueCat](https://app.revenuecat.com/): Go to your project settings, and under \"Integrations\", click \"Add\", then \"Firebase\".\n- From the newly created integration, copy your _shared secret_. You will need this to set up the extension.\n\n##### Mobile App\n\nFollow the steps in the [RevenueCat documentation](https://docs.revenuecat.com/docs/getting-started) to add the RevenueCat SDK to your mobile app. In addition, follow the instructions to [set up the Firebase Integration](https://docs.revenuecat.com/docs/firebase-integration) inside the app by:\n\n- Listening to Firebase Authentication events and [setting the RevenueCat app user ID to the Firebase UID](https://docs.revenuecat.com/docs/firebase-integration#2-set-firebase-user-identity-in-revenuecat).\n- Setting the [reserved RevenueCat subscriber attribute](https://docs.revenuecat.com/docs/firebase-integration#set-firebaseappinstanceid-as-a-subscriber-attribute) `$firebaseAppInstanceId` to the Firebase App Instance ID if you want to send events to Google Analytics for Firebase.\n\n#### Billing\n\nThis extension uses the following Firebase services which may have associated charges:\n\n- Cloud Firestore\n- Cloud Functions\n- Cloud Secret Manager\n- If you enable events [Eventarc fees apply](https://cloud.google.com/eventarc/pricing).\n\nThis extension also uses the following third-party services:\n\n- RevenueCat ([RevenueCat pricing information](https://www.revenuecat.com/pricing)).\n\nYou are responsible for any costs associated with your use of these services.\n\n","postinstallContent":"#### Set your Cloud Firestore security rules\n\n[Set up your security roles](https://docs.revenuecat.com/docs/firebase-integration#set-your-cloud-firestore-security-rules) so that only authenticated users can access customer information, and that each user can only access their own information. \n\n```\nrules_version = '2';\nservice cloud.firestore {\n  match /databases/{database}/documents {\n    match /${param:REVENUECAT_CUSTOMERS_COLLECTION}/{uid} {\n      allow read: if request.auth.uid == uid;\n    }\n\n    match /${param:REVENUECAT_EVENTS_COLLECTION}/{id} {\n      allow read: if request.auth.uid == resource.data.app_user_id\n    }\n  }\n}\n```\n\n#### Configure the Firebase Integration in the RevenueCat dashboard\n\nLog in to your [RevenueCat Account](https://app.revenuecat.com), select your project in the navigation, then go to integrations -> Firebase. In the section \"RevenueCat Firebase Extension\", in the field **Webhook URL**, enter the following value: \n```\n${function:handler.url}\n```\n\n##### Configure the RevenueCat SDK in your mobile app\n\nFollow the steps in the [RevenueCat documentation](https://docs.revenuecat.com/docs/getting-started) to add the RevenueCat SDK to your mobile app. In addition, follow the instructions to [set up the Firebase Integration](https://docs.revenuecat.com/docs/firebase-integration) inside the app by:\n\n- Listening to Firebase Authentication events and [setting the RevenueCat app user ID to the Firebase UID](https://docs.revenuecat.com/docs/firebase-integration#2-set-firebase-user-identity-in-revenuecat).\n- Setting the [reserved RevenueCat subscriber attribute](https://docs.revenuecat.com/docs/firebase-integration#set-firebaseappinstanceid-as-a-subscriber-attribute) `$firebaseAppInstanceId` to the Firebase App Instance ID if you want to send events to Google Analytics for Firebase.\n\n### Using the extension\n\n#### Making purchases\n\nTo make in-app purchases, use the RevenueCat SDK in your mobile app as per [the RevenueCat documentation](https://docs.revenuecat.com/docs/making-purchases).\n\n#### Checking entitlement access\n\nTo check access to entitlements, you can either [use the RevenueCat SDK](https://docs.revenuecat.com/docs/getting-started#10-get-subscription-status) or use Firebase Authentication custom claims. For example, to check whether the current user has access to an entitlement called `premium`, you could use the following Firebase code:\n\n```javascript\ngetAuth().currentUser.getIdTokenResult()\n  .then((idTokenResult) => {\n     // Confirm the user has a premium entitlement.\n     if (!!idTokenResult.claims.activeEntitlements.includes(\"premium\")) {\n       // Show premium UI.\n       showPremiumUI();\n     } else {\n       // Show regular user UI.\n       showFreeUI();\n     }\n  })\n  .catch((error) => {\n    console.log(error);\n  });\n```\n\n#### List a user's active subscriptions\n\nTo list a user's active subscriptions, you could use the following Firebase code:\n\n```javascript\ngetDoc(doc(db, \"${param:REVENUECAT_CUSTOMERS_COLLECTION}\", getAuth().currentUser.uid))\n  .then((snapshot) => {\n    if (snapshot.exists()) {\n      snapshot.subscriptions\n        .filter(subscription => new Date(subscription.expires_date) >= new Date())\n        .forEach(subscription => console.log(JSON.stringify(subscription)));\n    }\n  });\n```\n\n#### React to subscription lifecycle events\n\nSubscription lifecycle events get stored as events in the Firestore collection `${param:REVENUECAT_EVENTS_COLLECTION}`. By listening to changes in this collection, for example, through [Cloud Firestore triggered Firebase Cloud Functions](https://firebase.google.com/docs/functions/firestore-events), you can trigger any custom behavior that you want. An example could be sending push notifications to customers with billing issues to prompt them to update their credit cards. To do that, you would:\n\n- Store a push notification token for each of your app users, e.g., using [Firebase Cloud Messaging](https://firebase.google.com/docs/cloud-messaging)\n- Create a new Cloud Function triggered whenever a new document is created in the `${param:REVENUECAT_EVENTS_COLLECTION}` collection\n- In the Cloud Function, determine if the `type` field of the new document is `\"BILLING_ISSUE\"`\n- If so, look up the app user ID from the `app_user_id` field of the new document\n- Look up the push token for that app user ID and send a push notification\n","readmeContent":"# firestore-revenuecat-purchases\n\n[Documentation](https://docs.revenuecat.com/docs/firebase-integration)\n\n[Install this extension](https://firebase.google.com/products/extensions/revenuecat-firestore-revenuecat-purchases)\n\nThis extension uses Firebase services as your RevenueCat backend for in-app purchases on Apple App Store, Google Play Store, and Amazon Appstore to control access to premium content and sync customer purchase information to Firestore. For example, you might want to:\n\n- Store purchase lifecycle events (e.g., trial starts, purchases, subscription renewals, billing issues) in Firestore and react to them.\n- Store and update information about customers and their purchases in Firestore.\n- Update information about customers' entitlements as Firebase Authentication Custom Claims.\n","displayName":"Enable In-App Purchases with RevenueCat","events":[{"type":"com.revenuecat.v1.test","description":"Occurs whenever a test event issued through the RevenueCat dashboard."},{"type":"com.revenuecat.v1.initial_purchase","description":"Occurs whenever a new subscription has been purchased."},{"type":"com.revenuecat.v1.non_renewing_purchase","description":"Occurs whenever a customer has made a purchase that will not auto-renew."},{"type":"com.revenuecat.v1.renewal","description":"Occurs whenever an existing subscription has been renewed. This may occur at the end of the current billing period or later if a lapsed user re-subscribes."},{"type":"com.revenuecat.v1.product_change","description":"Occurs whenever a subscriber has changed the product of their subscription"},{"type":"com.revenuecat.v1.cancellation","description":"Occurs whenever a subscription or non-renewing purchase has been cancelled. See cancellation reasons for more details."},{"type":"com.revenuecat.v1.uncancellation","description":"Occurs whenever an auto-renew status has been re-enabled for a subscription."},{"type":"com.revenuecat.v1.billing_issue","description":"Occurs whenever there has been a problem trying to charge the subscriber. This does not mean the subscription has expired."},{"type":"com.revenuecat.v1.subscriber_alias","description":"Deprecated. Occurs whenever a new app_user_id has been registered for an existing subscriber."},{"type":"com.revenuecat.v1.subscription_paused","description":"Occurs whenever a subscription has been paused."},{"type":"com.revenuecat.v1.transfer","description":"Occurs whenever a transfer of transactions and entitlements was initiated between one App User ID(s) to another."},{"type":"com.revenuecat.v1.expiration","description":"Occurs whenever a subscription has expired and access should be removed."}]},"fetchTime":"2025-09-02T15:10:58.599062Z","lastOperationName":"projects/revenuecat-extensions/operations/6a6ef7fa-6084-4567-a5bf-35eef1ca74d0","state":"ACTIVE"},"params":{"LOCATION":"us-east1","SET_CUSTOM_CLAIMS":"DISABLED","REVENUECAT_SHARED_SECRET":"projects/280489246228/secrets/firestore-revenuecat-purchases-REVENUECAT_SHARED_SECRET/versions/1"},"populatedPostinstallContent":"#### Set your Cloud Firestore security rules\n\n[Set up your security roles](https://docs.revenuecat.com/docs/firebase-integration#set-your-cloud-firestore-security-rules) so that only authenticated users can access customer information, and that each user can only access their own information. \n\n```\nrules_version = '2';\nservice cloud.firestore {\n  match /databases/{database}/documents {\n    match /{ unspecified parameter }/{uid} {\n      allow read: if request.auth.uid == uid;\n    }\n\n    match /{ unspecified parameter }/{id} {\n      allow read: if request.auth.uid == resource.data.app_user_id\n    }\n  }\n}\n```\n\n#### Configure the Firebase Integration in the RevenueCat dashboard\n\nLog in to your [RevenueCat Account](https://app.revenuecat.com), select your project in the navigation, then go to integrations -> Firebase. In the section \"RevenueCat Firebase Extension\", in the field **Webhook URL**, enter the following value: \n```\nhttps://us-east1-app-tdi.cloudfunctions.net/ext-firestore-revenuecat-purchases-handler\n```\n\n##### Configure the RevenueCat SDK in your mobile app\n\nFollow the steps in the [RevenueCat documentation](https://docs.revenuecat.com/docs/getting-started) to add the RevenueCat SDK to your mobile app. In addition, follow the instructions to [set up the Firebase Integration](https://docs.revenuecat.com/docs/firebase-integration) inside the app by:\n\n- Listening to Firebase Authentication events and [setting the RevenueCat app user ID to the Firebase UID](https://docs.revenuecat.com/docs/firebase-integration#2-set-firebase-user-identity-in-revenuecat).\n- Setting the [reserved RevenueCat subscriber attribute](https://docs.revenuecat.com/docs/firebase-integration#set-firebaseappinstanceid-as-a-subscriber-attribute) `$firebaseAppInstanceId` to the Firebase App Instance ID if you want to send events to Google Analytics for Firebase.\n\n### Using the extension\n\n#### Making purchases\n\nTo make in-app purchases, use the RevenueCat SDK in your mobile app as per [the RevenueCat documentation](https://docs.revenuecat.com/docs/making-purchases).\n\n#### Checking entitlement access\n\nTo check access to entitlements, you can either [use the RevenueCat SDK](https://docs.revenuecat.com/docs/getting-started#10-get-subscription-status) or use Firebase Authentication custom claims. For example, to check whether the current user has access to an entitlement called `premium`, you could use the following Firebase code:\n\n```javascript\ngetAuth().currentUser.getIdTokenResult()\n  .then((idTokenResult) => {\n     // Confirm the user has a premium entitlement.\n     if (!!idTokenResult.claims.activeEntitlements.includes(\"premium\")) {\n       // Show premium UI.\n       showPremiumUI();\n     } else {\n       // Show regular user UI.\n       showFreeUI();\n     }\n  })\n  .catch((error) => {\n    console.log(error);\n  });\n```\n\n#### List a user's active subscriptions\n\nTo list a user's active subscriptions, you could use the following Firebase code:\n\n```javascript\ngetDoc(doc(db, \"{ unspecified parameter }\", getAuth().currentUser.uid))\n  .then((snapshot) => {\n    if (snapshot.exists()) {\n      snapshot.subscriptions\n        .filter(subscription => new Date(subscription.expires_date) >= new Date())\n        .forEach(subscription => console.log(JSON.stringify(subscription)));\n    }\n  });\n```\n\n#### React to subscription lifecycle events\n\nSubscription lifecycle events get stored as events in the Firestore collection `{ unspecified parameter }`. By listening to changes in this collection, for example, through [Cloud Firestore triggered Firebase Cloud Functions](https://firebase.google.com/docs/functions/firestore-events), you can trigger any custom behavior that you want. An example could be sending push notifications to customers with billing issues to prompt them to update their credit cards. To do that, you would:\n\n- Store a push notification token for each of your app users, e.g., using [Firebase Cloud Messaging](https://firebase.google.com/docs/cloud-messaging)\n- Create a new Cloud Function triggered whenever a new document is created in the `{ unspecified parameter }` collection\n- In the Cloud Function, determine if the `type` field of the new document is `\"BILLING_ISSUE\"`\n- If so, look up the app user ID from the `app_user_id` field of the new document\n- Look up the push token for that app user ID and send a push notification\n","extensionRef":"revenuecat/firestore-revenuecat-purchases","extensionVersion":"0.1.18","systemParams":{"firebaseextensions.v1beta.function/minInstances":"0","firebaseextensions.v1beta.function/memory":"256","firebaseextensions.v1beta.function/vpcConnectorEgressSettings":"VPC_CONNECTOR_EGRESS_SETTINGS_UNSPECIFIED"}},"lastOperationName":"projects/app-tdi/operations/fadf2e19-ac4e-4ba0-8640-1830ed41148f","serviceAccountEmail":"ext-firestore-revenuecat--ash8@app-tdi.iam.gserviceaccount.com","lastOperationType":"CREATE","etag":"d9ce61e78429c6ddba579fff7bee7bd421d34f3f591e65b3ca7963df914017e9"}]}
[info] i  functions: preparing functions directory for uploading... 
[info] i  functions: packaged /Users/leo/plural-connect/functions (112.02 KB) for uploading 
[debug] [2026-01-04T02:15:08.347Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:08.347Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:08.347Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/projects/app-tdi/locations/-/functions [none]
[debug] [2026-01-04T02:15:08.926Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/projects/app-tdi/locations/-/functions 200
[debug] [2026-01-04T02:15:08.926Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/projects/app-tdi/locations/-/functions {"functions":[{"name":"projects/app-tdi/locations/us-east1/functions/ext-firestore-revenuecat-purchases-handler","description":"Listens for RevenueCat server webhook requests, and store customer information and events in Cloud Firestore.","sourceArchiveUrl":"gs://firebase-mod-sources-prod/482ac9307b035390538357573b35956287c746e8f6ff5cdc45660f9d67a6d720","httpsTrigger":{"url":"https://us-east1-app-tdi.cloudfunctions.net/ext-firestore-revenuecat-purchases-handler","securityLevel":"SECURE_OPTIONAL"},"status":"ACTIVE","entryPoint":"handler","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"ext-firestore-revenuecat--ash8@app-tdi.iam.gserviceaccount.com","updateTime":"2025-12-30T17:25:56.098Z","versionId":"2","labels":{"goog-firebase-ext":"firestore-revenuecat-purchases","deployment-tool":"firebase-extensions","goog-firebase-ext-iid":"firestore-revenuecat-purchases","firebase-extensions-ar":"enabled","goog-dm":"firebase-ext-firestore-revenuecat-purchases"},"environmentVariables":{"DATABASE_INSTANCE":"","DATABASE_URL":"","EXT_INSTANCE_ID":"firestore-revenuecat-purchases","FIREBASE_CONFIG":"{\"projectId\":\"app-tdi\",\"databaseURL\":\"\",\"storageBucket\":\"app-tdi.firebasestorage.app\"}","GCLOUD_PROJECT":"app-tdi","LOCATION":"us-east1","PROJECT_ID":"app-tdi","SET_CUSTOM_CLAIMS":"DISABLED","STORAGE_BUCKET":"app-tdi.firebasestorage.app"},"runtime":"nodejs20","ingressSettings":"ALLOW_ALL","buildId":"30d48f4c-ca11-4408-9d27-aa724bd81d1b","buildEnvironmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"secretEnvironmentVariables":[{"key":"REVENUECAT_SHARED_SECRET","projectId":"280489246228","secret":"firestore-revenuecat-purchases-REVENUECAT_SHARED_SECRET","version":"1"}],"buildName":"projects/280489246228/locations/us-east1/builds/30d48f4c-ca11-4408-9d27-aa724bd81d1b","dockerRegistry":"ARTIFACT_REGISTRY","automaticUpdatePolicy":{},"buildServiceAccount":"projects/app-tdi/serviceAccounts/280489246228-compute@developer.gserviceaccount.com","satisfiesPzi":true}]}
[debug] [2026-01-04T02:15:08.927Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:08.927Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:08.927Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/app-tdi/locations/-/functions filter=environment%3D%22GEN_2%22
[debug] [2026-01-04T02:15:09.906Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/app-tdi/locations/-/functions 200
[debug] [2026-01-04T02:15:09.906Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/app-tdi/locations/-/functions {}
[debug] [2026-01-04T02:15:09.912Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:09.912Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:09.912Z] >>> [apiv2][query] GET https://cloudresourcemanager.googleapis.com/v1/projects/app-tdi [none]
[debug] [2026-01-04T02:15:10.088Z] <<< [apiv2][status] GET https://cloudresourcemanager.googleapis.com/v1/projects/app-tdi 200
[debug] [2026-01-04T02:15:10.088Z] <<< [apiv2][body] GET https://cloudresourcemanager.googleapis.com/v1/projects/app-tdi {"projectNumber":"280489246228","projectId":"app-tdi","lifecycleState":"ACTIVE","name":"app-tdi","labels":{"firebase":"enabled","firebase-core":"disabled"},"createTime":"2025-12-28T23:42:34.253168Z"}
[debug] [2026-01-04T02:15:10.090Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:10.090Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:10.090Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/app-tdi/releases pageSize=10&pageToken=
[debug] [2026-01-04T02:15:10.823Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/app-tdi/releases 200
[debug] [2026-01-04T02:15:10.824Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/app-tdi/releases {"releases":[{"name":"projects/app-tdi/releases/cloud.firestore","rulesetName":"projects/app-tdi/rulesets/bf90c93b-b497-4f69-be80-2ab4fcb53bea","createTime":"2025-12-28T23:58:10.777341Z","updateTime":"2026-01-03T19:14:24.487468Z"},{"name":"projects/app-tdi/releases/firebase.storage/app-tdi.firebasestorage.app","rulesetName":"projects/app-tdi/rulesets/35667b1d-581c-4ce7-93e8-38149ee3b782","createTime":"2025-12-29T02:26:20.169161Z","updateTime":"2025-12-29T18:40:54.353410Z"}]}
[debug] [2026-01-04T02:15:10.835Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:10.835Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:10.835Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/app-tdi/rulesets/35667b1d-581c-4ce7-93e8-38149ee3b782 [none]
[debug] [2026-01-04T02:15:11.010Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/app-tdi/rulesets/35667b1d-581c-4ce7-93e8-38149ee3b782 200
[debug] [2026-01-04T02:15:11.010Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/app-tdi/rulesets/35667b1d-581c-4ce7-93e8-38149ee3b782 [omitted]
[info] i  storage: uploading rules storage.rules... 
[debug] [2026-01-04T02:15:11.011Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:11.011Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:11.011Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/app-tdi/rulesets [none]
[debug] [2026-01-04T02:15:11.011Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/app-tdi/rulesets [omitted]
[debug] [2026-01-04T02:15:11.354Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/app-tdi/rulesets 200
[debug] [2026-01-04T02:15:11.354Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/app-tdi/rulesets {"name":"projects/app-tdi/rulesets/a9775638-3507-4b46-b75f-f51b3db74a9f","source":{"files":[{"content":"rules_version = '2';\nservice firebase.storage {\n  match /b/{bucket}/o {\n    // Helper to check auth\n    function isAuthenticated() {\n      return request.auth != null;\n    }\n\n    // Avatars: Public read, authenticated user write\n    match /avatars/{allPaths=**} {\n      allow read: if true;\n      allow write: if isAuthenticated();\n    }\n    \n    // Post images: Public read, authenticated user write\n    match /posts/{allPaths=**} {\n      allow read: if true;\n      allow write: if isAuthenticated();\n    }\n    \n    // Profile images - in case they use a different path\n    match /profiles/{allPaths=**} {\n      allow read: if true;\n      allow write: if isAuthenticated();\n    }\n    \n    // Images folder - catch-all for any image uploads\n    match /images/{allPaths=**} {\n      allow read: if true;\n      allow write: if isAuthenticated();\n    }\n    // Visual DNA images\n    match /visual_dna/{allPaths=**} {\n      allow read: if true;\n      allow write: if isAuthenticated();\n    }\n\n  }\n}\n","name":"storage.rules"}]},"createTime":"2026-01-04T02:15:11.317887Z","metadata":{"services":["firebase.storage"]}}
[debug] [2026-01-04T02:15:11.354Z] [rules] created ruleset projects/app-tdi/rulesets/a9775638-3507-4b46-b75f-f51b3db74a9f
[debug] [2026-01-04T02:15:11.356Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:11.356Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:11.356Z] >>> [apiv2][query] GET https://cloudbilling.googleapis.com/v1/projects/app-tdi/billingInfo [none]
[debug] [2026-01-04T02:15:12.534Z] <<< [apiv2][status] GET https://cloudbilling.googleapis.com/v1/projects/app-tdi/billingInfo 200
[debug] [2026-01-04T02:15:12.534Z] <<< [apiv2][body] GET https://cloudbilling.googleapis.com/v1/projects/app-tdi/billingInfo {"name":"projects/app-tdi/billingInfo","projectId":"app-tdi","billingAccountName":"billingAccounts/0198FE-F962F9-E3E384","billingEnabled":true}
[debug] [2026-01-04T02:15:12.535Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:12.535Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:12.535Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v1/projects/app-tdi/locations/us-central1/functions:generateUploadUrl [none]
[debug] [2026-01-04T02:15:12.536Z] >>> [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/app-tdi/locations/us-central1/functions:generateUploadUrl {}
[debug] [2026-01-04T02:15:13.090Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v1/projects/app-tdi/locations/us-central1/functions:generateUploadUrl 200
[debug] [2026-01-04T02:15:13.090Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/app-tdi/locations/us-central1/functions:generateUploadUrl {"uploadUrl":"https://storage.googleapis.com/uploads-715625082736.us-central1.cloudfunctions.appspot.com/d6fe301a-04a6-4b38-97f1-66eac407083b.zip?GoogleAccessId=service-280489246228@gcf-admin-robot.iam.gserviceaccount.com&Expires=1767494713&Signature=EhHSO8cJSIV41k3w7r%2FOiUZKgozvbavCNo7DO2Mw02dWTJ4U8TS6ZA4qAHQeQ6ieKX130S73F2h6M7tQt6hhHvsdtW0IFXJjvNfeAZDvIdA5SXDF5fMcDjWVIjd4a0NdubigYQtCqZ9znPxKssfp54g9UFI3NiRnCn%2BgS%2BhUscmRtZi9oC9c%2FH%2BuiF%2FRnP8%2Flii5IAZGU7hGdbC7hbrhSFEVqX3Jt0Cs%2Fa89xqlnUPzkirTUY7MUFl2Dv42mCryAeEqbC6StsxOm%2BoQI8uafQc%2FWgMjeFpZvfqQ6axDN9NpmM8amo0%2F061Lwwg8kggBwgIgOUqu8bBNFT%2FLKA%2FYGSw%3D%3D"}
[debug] [2026-01-04T02:15:13.090Z] >>> [apiv2][query] PUT https://storage.googleapis.com/uploads-715625082736.us-central1.cloudfunctions.appspot.com/d6fe301a-04a6-4b38-97f1-66eac407083b.zip GoogleAccessId=service-280489246228%40gcf-admin-robot.iam.gserviceaccount.com&Expires=1767494713&Signature=EhHSO8cJSIV41k3w7r%2FOiUZKgozvbavCNo7DO2Mw02dWTJ4U8TS6ZA4qAHQeQ6ieKX130S73F2h6M7tQt6hhHvsdtW0IFXJjvNfeAZDvIdA5SXDF5fMcDjWVIjd4a0NdubigYQtCqZ9znPxKssfp54g9UFI3NiRnCn%2BgS%2BhUscmRtZi9oC9c%2FH%2BuiF%2FRnP8%2Flii5IAZGU7hGdbC7hbrhSFEVqX3Jt0Cs%2Fa89xqlnUPzkirTUY7MUFl2Dv42mCryAeEqbC6StsxOm%2BoQI8uafQc%2FWgMjeFpZvfqQ6axDN9NpmM8amo0%2F061Lwwg8kggBwgIgOUqu8bBNFT%2FLKA%2FYGSw%3D%3D
[debug] [2026-01-04T02:15:13.090Z] >>> [apiv2][body] PUT https://storage.googleapis.com/uploads-715625082736.us-central1.cloudfunctions.appspot.com/d6fe301a-04a6-4b38-97f1-66eac407083b.zip [stream]
[debug] [2026-01-04T02:15:13.702Z] <<< [apiv2][status] PUT https://storage.googleapis.com/uploads-715625082736.us-central1.cloudfunctions.appspot.com/d6fe301a-04a6-4b38-97f1-66eac407083b.zip 200
[debug] [2026-01-04T02:15:13.702Z] <<< [apiv2][body] PUT https://storage.googleapis.com/uploads-715625082736.us-central1.cloudfunctions.appspot.com/d6fe301a-04a6-4b38-97f1-66eac407083b.zip [omitted]
[info] ✔  functions: functions source uploaded successfully 
[debug] [2026-01-04T02:15:13.703Z] [rules] releasing firebase.storage/app-tdi.firebasestorage.app with ruleset projects/app-tdi/rulesets/a9775638-3507-4b46-b75f-f51b3db74a9f
[debug] [2026-01-04T02:15:13.704Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:13.704Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:13.704Z] >>> [apiv2][query] PATCH https://firebaserules.googleapis.com/v1/projects/app-tdi/releases/firebase.storage/app-tdi.firebasestorage.app [none]
[debug] [2026-01-04T02:15:13.704Z] >>> [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/app-tdi/releases/firebase.storage/app-tdi.firebasestorage.app {"release":{"name":"projects/app-tdi/releases/firebase.storage/app-tdi.firebasestorage.app","rulesetName":"projects/app-tdi/rulesets/a9775638-3507-4b46-b75f-f51b3db74a9f"}}
[debug] [2026-01-04T02:15:14.137Z] <<< [apiv2][status] PATCH https://firebaserules.googleapis.com/v1/projects/app-tdi/releases/firebase.storage/app-tdi.firebasestorage.app 200
[debug] [2026-01-04T02:15:14.138Z] <<< [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/app-tdi/releases/firebase.storage/app-tdi.firebasestorage.app {"name":"projects/app-tdi/releases/firebase.storage/app-tdi.firebasestorage.app","rulesetName":"projects/app-tdi/rulesets/a9775638-3507-4b46-b75f-f51b3db74a9f","createTime":"2025-12-29T02:26:20.169161Z","updateTime":"2026-01-04T02:15:14.109360Z"}
[debug] [2026-01-04T02:15:14.138Z] [rules] updated release projects/app-tdi/releases/firebase.storage/app-tdi.firebasestorage.app
[info] ✔  storage: released rules storage.rules to firebase.storage 
[info] i  functions: creating Node.js 22 (1st Gen) function performBirthRitual(us-central1)... 
[info] i  functions: creating Node.js 22 (1st Gen) function generateMagicPost(us-central1)... 
[debug] [2026-01-04T02:15:14.140Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:14.140Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:14.140Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v1/projects/app-tdi/locations/us-central1/functions [none]
[debug] [2026-01-04T02:15:14.140Z] >>> [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/app-tdi/locations/us-central1/functions {"name":"projects/app-tdi/locations/us-central1/functions/performBirthRitual","sourceUploadUrl":"https://storage.googleapis.com/uploads-715625082736.us-central1.cloudfunctions.appspot.com/d6fe301a-04a6-4b38-97f1-66eac407083b.zip?GoogleAccessId=service-280489246228@gcf-admin-robot.iam.gserviceaccount.com&Expires=1767494713&Signature=EhHSO8cJSIV41k3w7r%2FOiUZKgozvbavCNo7DO2Mw02dWTJ4U8TS6ZA4qAHQeQ6ieKX130S73F2h6M7tQt6hhHvsdtW0IFXJjvNfeAZDvIdA5SXDF5fMcDjWVIjd4a0NdubigYQtCqZ9znPxKssfp54g9UFI3NiRnCn%2BgS%2BhUscmRtZi9oC9c%2FH%2BuiF%2FRnP8%2Flii5IAZGU7hGdbC7hbrhSFEVqX3Jt0Cs%2Fa89xqlnUPzkirTUY7MUFl2Dv42mCryAeEqbC6StsxOm%2BoQI8uafQc%2FWgMjeFpZvfqQ6axDN9NpmM8amo0%2F061Lwwg8kggBwgIgOUqu8bBNFT%2FLKA%2FYGSw%3D%3D","entryPoint":"performBirthRitual","runtime":"nodejs22","dockerRegistry":"ARTIFACT_REGISTRY","labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"6256d6cab430a8b6f2c09ba1eff7f1f69a56e6da"},"httpsTrigger":{"securityLevel":"SECURE_ALWAYS"},"minInstances":null,"maxInstances":null,"ingressSettings":null,"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"app-tdi\",\"storageBucket\":\"app-tdi.firebasestorage.app\"}","GCLOUD_PROJECT":"app-tdi","EVENTARC_CLOUD_EVENT_SOURCE":"projects/app-tdi/locations/us-central1/functions/performBirthRitual"},"serviceAccountEmail":null,"availableMemoryMb":null,"timeout":null,"vpcConnector":null,"vpcConnectorEgressSettings":null,"buildEnvironmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""}}
[debug] [2026-01-04T02:15:17.572Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v1/projects/app-tdi/locations/us-central1/functions 200
[debug] [2026-01-04T02:15:17.572Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/app-tdi/locations/us-central1/functions {"name":"operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v1.OperationMetadataV1","target":"projects/app-tdi/locations/us-central1/functions/performBirthRitual","updateTime":"2026-01-04T02:15:17.531839267Z"}}
[debug] [2026-01-04T02:15:17.573Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:17.573Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:17.573Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5 [none]
[debug] [2026-01-04T02:15:17.755Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5 200
[debug] [2026-01-04T02:15:17.755Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5 {"name":"operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v1.OperationMetadataV1","target":"projects/app-tdi/locations/us-central1/functions/performBirthRitual","updateTime":"2026-01-04T02:15:17.531839267Z"}}
[debug] [2026-01-04T02:15:18.256Z] [create-default-us-central1-performBirthRitual] Retrying task index 0
[debug] [2026-01-04T02:15:18.257Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:18.257Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:18.257Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5 [none]
[debug] [2026-01-04T02:15:18.446Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5 200
[debug] [2026-01-04T02:15:18.446Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5 {"name":"operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v1.OperationMetadataV1","target":"projects/app-tdi/locations/us-central1/functions/performBirthRitual","type":"CREATE_FUNCTION","request":{"@type":"type.googleapis.com/google.cloud.functions.v1.CloudFunction","name":"projects/app-tdi/locations/us-central1/functions/performBirthRitual","httpsTrigger":{"securityLevel":"SECURE_ALWAYS"},"entryPoint":"performBirthRitual","updateTime":"1970-01-01T00:00:00Z","labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"6256d6cab430a8b6f2c09ba1eff7f1f69a56e6da"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-715625082736.us-central1.cloudfunctions.appspot.com/d6fe301a-04a6-4b38-97f1-66eac407083b.zip?GoogleAccessId=service-280489246228@gcf-admin-robot.iam.gserviceaccount.com&Expires=1767494713&Signature=EhHSO8cJSIV41k3w7r%2FOiUZKgozvbavCNo7DO2Mw02dWTJ4U8TS6ZA4qAHQeQ6ieKX130S73F2h6M7tQt6hhHvsdtW0IFXJjvNfeAZDvIdA5SXDF5fMcDjWVIjd4a0NdubigYQtCqZ9znPxKssfp54g9UFI3NiRnCn%2BgS%2BhUscmRtZi9oC9c%2FH%2BuiF%2FRnP8%2Flii5IAZGU7hGdbC7hbrhSFEVqX3Jt0Cs%2Fa89xqlnUPzkirTUY7MUFl2Dv42mCryAeEqbC6StsxOm%2BoQI8uafQc%2FWgMjeFpZvfqQ6axDN9NpmM8amo0%2F061Lwwg8kggBwgIgOUqu8bBNFT%2FLKA%2FYGSw%3D%3D","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"app-tdi\",\"storageBucket\":\"app-tdi.firebasestorage.app\"}","GCLOUD_PROJECT":"app-tdi","EVENTARC_CLOUD_EVENT_SOURCE":"projects/app-tdi/locations/us-central1/functions/performBirthRitual"},"runtime":"nodejs22","buildEnvironmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRegistry":"ARTIFACT_REGISTRY"},"versionId":"1","updateTime":"2026-01-04T02:15:17.531839267Z"}}
[debug] [2026-01-04T02:15:19.446Z] [create-default-us-central1-performBirthRitual] Retrying task index 0
[debug] [2026-01-04T02:15:19.446Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:19.446Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:19.446Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5 [none]
[debug] [2026-01-04T02:15:19.610Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5 200
[debug] [2026-01-04T02:15:19.610Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5 {"name":"operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v1.OperationMetadataV1","target":"projects/app-tdi/locations/us-central1/functions/performBirthRitual","type":"CREATE_FUNCTION","request":{"@type":"type.googleapis.com/google.cloud.functions.v1.CloudFunction","name":"projects/app-tdi/locations/us-central1/functions/performBirthRitual","httpsTrigger":{"securityLevel":"SECURE_ALWAYS"},"entryPoint":"performBirthRitual","updateTime":"1970-01-01T00:00:00Z","labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"6256d6cab430a8b6f2c09ba1eff7f1f69a56e6da"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-715625082736.us-central1.cloudfunctions.appspot.com/d6fe301a-04a6-4b38-97f1-66eac407083b.zip?GoogleAccessId=service-280489246228@gcf-admin-robot.iam.gserviceaccount.com&Expires=1767494713&Signature=EhHSO8cJSIV41k3w7r%2FOiUZKgozvbavCNo7DO2Mw02dWTJ4U8TS6ZA4qAHQeQ6ieKX130S73F2h6M7tQt6hhHvsdtW0IFXJjvNfeAZDvIdA5SXDF5fMcDjWVIjd4a0NdubigYQtCqZ9znPxKssfp54g9UFI3NiRnCn%2BgS%2BhUscmRtZi9oC9c%2FH%2BuiF%2FRnP8%2Flii5IAZGU7hGdbC7hbrhSFEVqX3Jt0Cs%2Fa89xqlnUPzkirTUY7MUFl2Dv42mCryAeEqbC6StsxOm%2BoQI8uafQc%2FWgMjeFpZvfqQ6axDN9NpmM8amo0%2F061Lwwg8kggBwgIgOUqu8bBNFT%2FLKA%2FYGSw%3D%3D","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"app-tdi\",\"storageBucket\":\"app-tdi.firebasestorage.app\"}","GCLOUD_PROJECT":"app-tdi","EVENTARC_CLOUD_EVENT_SOURCE":"projects/app-tdi/locations/us-central1/functions/performBirthRitual"},"runtime":"nodejs22","buildEnvironmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRegistry":"ARTIFACT_REGISTRY"},"versionId":"1","updateTime":"2026-01-04T02:15:17.531839267Z"}}
[debug] [2026-01-04T02:15:21.614Z] [create-default-us-central1-performBirthRitual] Retrying task index 0
[debug] [2026-01-04T02:15:21.616Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:21.616Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:21.616Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5 [none]
[debug] [2026-01-04T02:15:21.779Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5 200
[debug] [2026-01-04T02:15:21.779Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5 {"name":"operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v1.OperationMetadataV1","target":"projects/app-tdi/locations/us-central1/functions/performBirthRitual","type":"CREATE_FUNCTION","request":{"@type":"type.googleapis.com/google.cloud.functions.v1.CloudFunction","name":"projects/app-tdi/locations/us-central1/functions/performBirthRitual","httpsTrigger":{"securityLevel":"SECURE_ALWAYS"},"entryPoint":"performBirthRitual","updateTime":"1970-01-01T00:00:00Z","labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"6256d6cab430a8b6f2c09ba1eff7f1f69a56e6da"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-715625082736.us-central1.cloudfunctions.appspot.com/d6fe301a-04a6-4b38-97f1-66eac407083b.zip?GoogleAccessId=service-280489246228@gcf-admin-robot.iam.gserviceaccount.com&Expires=1767494713&Signature=EhHSO8cJSIV41k3w7r%2FOiUZKgozvbavCNo7DO2Mw02dWTJ4U8TS6ZA4qAHQeQ6ieKX130S73F2h6M7tQt6hhHvsdtW0IFXJjvNfeAZDvIdA5SXDF5fMcDjWVIjd4a0NdubigYQtCqZ9znPxKssfp54g9UFI3NiRnCn%2BgS%2BhUscmRtZi9oC9c%2FH%2BuiF%2FRnP8%2Flii5IAZGU7hGdbC7hbrhSFEVqX3Jt0Cs%2Fa89xqlnUPzkirTUY7MUFl2Dv42mCryAeEqbC6StsxOm%2BoQI8uafQc%2FWgMjeFpZvfqQ6axDN9NpmM8amo0%2F061Lwwg8kggBwgIgOUqu8bBNFT%2FLKA%2FYGSw%3D%3D","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"app-tdi\",\"storageBucket\":\"app-tdi.firebasestorage.app\"}","GCLOUD_PROJECT":"app-tdi","EVENTARC_CLOUD_EVENT_SOURCE":"projects/app-tdi/locations/us-central1/functions/performBirthRitual"},"runtime":"nodejs22","buildEnvironmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRegistry":"ARTIFACT_REGISTRY"},"versionId":"1","updateTime":"2026-01-04T02:15:17.531839267Z"}}
[debug] [2026-01-04T02:15:25.784Z] [create-default-us-central1-performBirthRitual] Retrying task index 0
[debug] [2026-01-04T02:15:25.788Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:25.788Z] Checked if tokens are valid: true, expires at: 1767496066278
[debug] [2026-01-04T02:15:25.789Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5 [none]
[debug] [2026-01-04T02:15:25.989Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5 200
[debug] [2026-01-04T02:15:25.989Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5 {"name":"operations/cHJvamVjdHMvYXBwLXRkaS9sb2NhdGlvbnMvdXMtY2VudHJhbDEvb3BlcmF0aW9ucy9vcGVyYXRpb24tMTc2NzQ5MjkxNDMzNy02NDc4NjgzNGQ1ODFlLWVjZmFmMTExLTQyOGZlZmY5","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v1.OperationMetadataV1","target":"projects/app-tdi/locations/us-central1/functions/performBirthRitual","type":"CREATE_FUNCTION","request":{"@type":"type.googleapis.com/google.cloud.functions.v1.CloudFunction","name":"projects/app-tdi/locations/us-central1/functions/performBirthRitual","httpsTrigger":{"securityLevel":"SECURE_ALWAYS"},"entryPoint":"performBirthRitual","updateTime":"1970-01-01T00:00:00Z","labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"6256d6cab430a8b6f2c09ba1eff7f1f69a56e6da"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-715625082736.us-central1.cloudfunctions.appspot.com/d6fe301a-04a6-4b38-97f1-66eac407083b.zip?GoogleAccessId=service-280489246228@gcf-admin-robot.iam.gserviceaccount.com&Expires=1767494713&Signature=EhHSO8cJSIV41k3w7r%2FOiUZKgozvbavCNo7DO2Mw02dWTJ4U8TS6ZA4qAHQeQ6ieKX130S73F2h6M7tQt6hhHvsdtW0IFXJjvNfeAZDvIdA5SXDF5fMcDjWVIjd4a0NdubigYQtCqZ9znPxKssfp54g9UFI3NiRnCn%2BgS%2BhUscmRtZi9oC9c%2FH%2BuiF%2FRnP8%2Flii5IAZGU7hGdbC7hbrhSFEVqX3Jt0Cs%2Fa89xqlnUPzkirTUY7MUFl2Dv42mCryAeEqbC6StsxOm%2BoQI8uafQc%2FWgMjeFpZvfqQ6axDN9NpmM8amo0%2F061Lwwg8kggBwgIgOUqu8bBNFT%2FLKA%2FYGSw%3D%3D","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"app-tdi\",\"storageBucket\":\"app-tdi.firebasestorage.app\"}","GCLOUD_PROJECT":"app-tdi","EVENTARC_CLOUD_EVENT_SOURCE":"projects/app-tdi/locations/us-central1/functions/performBirthRitual"},"runtime":"nodejs22","buildEnvironmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRegistry":"ARTIFACT_REGISTRY"},"versionId":"1","updateTime":"2026-01-04T02:15:17.531839267Z"}}
